import{r as S,g as o,o as v,v as b,w as t,i as n,u as R,G as P,Y as N,b as q,s as D,D as z,t as F,U as H,c as V,y as O,F as L,V as M,a as g,l as y,h as J,x as I,p as Y,m as G}from"./index.a06947c9.js";import{u as K,a as j}from"./index.6a0f63a4.js";import{i as W}from"./types.22d094ed.js";import{d as X,q as Z,u as $,s as ee}from"./bpmn.233e1eb0.js";import"./index.203e7cb0.js";const w={ENABLE:"ENABLE",DISABLE:"STOP"},ae=[{label:"\u542F\u7528",value:w.ENABLE},{label:"\u7981\u7528",value:w.DISABLE}],te={__name:"edit",emits:["success"],setup(r,{expose:s,emit:C}){const e=S(!1),u=S(),m={url:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"change"}],bpmnName:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"change"}],classPath:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"change"}],status:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"change"}]},i=()=>({url:void 0,bpmnName:void 0,classPath:void 0,status:w.DISABLE}),l=S(i()),h=f=>{e.value=!0,e.value=!0,W(f)?l.value=i():l.value=JSON.parse(JSON.stringify(f))},p=()=>{l.value.status=l.value.status===w.DISABLE?w.ENABLE:w.DISABLE},_=async(f,d)=>{d.value=!0;try{await X(l.value),f(),P({message:"\u606D\u559C\u4F60\uFF0C\u64CD\u4F5C\u6210\u529F",type:"success"}),C("success")}finally{d.value=!1}};return s({open:h}),(f,d)=>{const E=o("el-input"),c=o("el-form-item"),a=o("el-col"),B=o("el-switch"),k=o("el-row"),U=o("el-form"),Q=o("yun-drawer");return v(),b(Q,{modelValue:e.value,"onUpdate:modelValue":d[2]||(d[2]=x=>e.value=x),size:"mediun",title:"\u7F16\u8F91","confirm-button-text":"\u786E\u5B9A","cancel-button-text":"\u53D6\u6D88",onConfirm:_},{default:t(()=>[n(U,{ref_key:"formRef",ref:u,model:l.value,"label-width":"120px",rules:m},{default:t(()=>[n(k,null,{default:t(()=>[n(a,null,{default:t(()=>[n(c,{label:"url",prop:"url"},{default:t(()=>[n(E,{modelValue:l.value.url,"onUpdate:modelValue":d[0]||(d[0]=x=>l.value.url=x),style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),n(a,null,{default:t(()=>[n(c,{label:"bpmn\u5305\u540D\u79F0",prop:"bpmnName"},{default:t(()=>[n(E,{modelValue:l.value.bpmnName,"onUpdate:modelValue":d[1]||(d[1]=x=>l.value.bpmnName=x),style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),n(a,null,{default:t(()=>[n(c,{label:"\u529F\u80FD\u72B6\u6001",prop:"status"},{default:t(()=>[n(B,{"active-text":"\u542F\u7528","inactive-text":"\u7981\u7528","inline-prompt":"",value:l.value.status===R(w).ENABLE,onClick:p},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}};var T=({doQuery:r}={})=>({fetchData:async({searchData:u,pagination:m})=>await Z({...u,...m}),handleToggleUninstall:async u=>{N.confirm("\u8BF7\u786E\u8BA4\u6B64\u64CD\u4F5C\u6267\u884C\u540E\u65E0\u4E0D\u826F\u540E\u679C\u3002","\u786E\u8BA4",{cancelButtonText:"\u53D6\u6D88",confirmButtonText:"\u786E\u5B9A",confirmButtonHandler:async(m,i)=>{i.value=!0;try{await $(u)}finally{i.value=!1}m(),await r()}})},handleInstall:async u=>{N.confirm("\u8BF7\u786E\u8BA4\u6B64\u64CD\u4F5C\u6267\u884C\u540E\u65E0\u4E0D\u826F\u540E\u679C\u3002","\u786E\u8BA4",{cancelButtonText:"\u53D6\u6D88",confirmButtonText:"\u786E\u5B9A",confirmButtonHandler:async(m,i)=>{i.value=!0;try{await ee({id:u.id})}finally{i.value=!1}m(),await r()}})}});const ne=[K("bpmnName","bpmn\u5305\u540D\u79F0"),j("status","\u72B6\u6001",{options:ae})],le={name:"SDKCardList",components:{editDrawer:te},setup(){const r=S([]),s=S(null),C=D({loading:{handleToggleUninstall:!1,doQuery:!1}}),e=z(),{loading:u}=F(C),m=S({size:10,page:1,total:100,small:!0}),i=T(),{fetchData:l}=i;let h=D({});const p=async()=>{u.value.doQuery=!0;try{const c=await l({searchData:h,pagination:m.value});r.value=c.bpmns}finally{u.value.doQuery=!1}},_=c=>{s.value.open(c)},f=({id:c,url:a,bpmnName:B})=>{e.push({path:"/process/bpmn/detail",query:{id:c,url:a,bpmnName:B}})},d=({id:c,url:a,bpmnName:B})=>{e.push({path:"/process/bpmn/edit",query:{id:c,url:a,bpmnName:B}})},E=async()=>{h=D({}),p()};return H(()=>{p()}),{loading:u,...T({...C,doQuery:p}),editDrawerRef:s,pagination:m,cardlist:r,searchFields:ne,form:h,doQuery:p,handleReset:E,handleEdit:_,StatusType:w,handleViewBpmn:f,handleEditBpmn:d}}},A=r=>(Y("data-v-ed9a87c8"),r=r(),G(),r),oe={class:"cardlist"},se=A(()=>g("i",{class:"yun-iconfont icon-add cardlist-add-icon"},null,-1)),re={class:"cardlist-card-wrap"},ie={class:"cardlist-card-content"},de=A(()=>g("div",{class:"cardlist-card-title"},I("BPMN"),-1)),ce={class:"cardlist-card-info"},ue={class:"cardlist-card-opera"};function me(r,s,C,e,u,m){const i=o("yun-filter"),l=o("el-card"),h=o("el-col"),p=o("el-tag"),_=o("el-button"),f=o("el-row"),d=o("yun-pagination"),E=o("editDrawer"),c=M("loading");return v(),V(L,null,[O((v(),b(l,{"body-style":{padding:"0 24px 24px 24px"},shadow:"never"},{default:t(()=>[n(i,{modelValue:e.form,"onUpdate:modelValue":s[0]||(s[0]=a=>e.form=a),mode:"search","form-props":{size:"small"},clearable:"",fields:e.searchFields,onSubmit:e.doQuery,onReset:e.handleReset},null,8,["modelValue","fields","onSubmit","onReset"]),g("div",oe,[n(f,{gutter:16},{default:t(()=>[n(h,{span:6},{default:t(()=>[n(l,{shadow:"never",class:"cardlist-add",onClick:s[1]||(s[1]=a=>e.handleEdit())},{default:t(()=>[se,y("\u6DFB\u52A0 ")]),_:1})]),_:1}),(v(!0),V(L,null,J(e.cardlist,(a,B)=>(v(),b(h,{key:B,span:6},{default:t(()=>[n(l,{shadow:"hover",class:"cardlist-card"},{default:t(()=>[g("div",re,[g("div",ie,[de,g("div",ce,[g("span",null,"bpmn\u540D\u79F0\uFF1A"+I(a.bpmnName),1),g("div",null,[y(" \u72B6\u6001\uFF1A "),a.status===e.StatusType.ENABLE?(v(),b(p,{key:0,type:"action"},{default:t(()=>[y(" \u542F\u7528 ")]),_:1})):(v(),b(p,{key:1,type:"danger"},{default:t(()=>[y(" \u7981\u7528 ")]),_:1}))])])])]),g("div",ue,[a.status===e.StatusType.ENABLE?(v(),b(_,{key:0,onClick:k=>r.handleToggleUninstall(a)},{default:t(()=>[y(" \u5378\u8F7D ")]),_:2},1032,["onClick"])):(v(),b(_,{key:1,onClick:k=>r.handleInstall(a)},{default:t(()=>[y(" \u542F\u7528 ")]),_:2},1032,["onClick"])),n(_,{type:"primary",onClick:k=>e.handleEdit(a)},{default:t(()=>[y(" \u7F16\u8F91 ")]),_:2},1032,["onClick"]),n(_,{type:"primary",onClick:k=>e.handleViewBpmn(a)},{default:t(()=>[y(" \u67E5\u770BB ")]),_:2},1032,["onClick"]),n(_,{type:"primary",onClick:k=>e.handleEditBpmn(a)},{default:t(()=>[y(" \u7F16\u8F91B ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),n(d,{modelValue:e.pagination.size,"onUpdate:modelValue":s[2]||(s[2]=a=>e.pagination.size=a),currentPage:e.pagination.page,"onUpdate:currentPage":s[3]||(s[3]=a=>e.pagination.page=a),total:e.pagination.total,small:e.pagination.small,onSizeChange:e.doQuery,onCurrentChange:e.doQuery,onPrevClick:e.doQuery,onNextClick:e.doQuery},null,8,["modelValue","currentPage","total","small","onSizeChange","onCurrentChange","onPrevClick","onNextClick"])]),_:1})),[[c,e.loading.doQuery]]),n(E,{ref:"editDrawerRef",onSuccess:e.doQuery},null,8,["onSuccess"])],64)}var ge=q(le,[["render",me],["__scopeId","data-v-ed9a87c8"]]);export{ge as default};
