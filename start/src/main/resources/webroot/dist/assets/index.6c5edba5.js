import{q as P,a as $,u as z,b as L}from"./log.c68a8790.js";import{u as R}from"./index.6a0f63a4.js";import{a1 as B,b as N,r as u,g as i,o as w,v as S,w as y,a as U,x as H,l as h,i as o,e as M,c as q,k as C,u as k,F,$ as E}from"./index.a3be559f.js";import"./index.a443cb70.js";const I=(v,c)=>v==null||v==null||v==""?"":B(v).format(c||"YYYY-MM-DD HH:mm:ss");const Y=["textContent"],A={__name:"exceptionDialog",props:{title:{type:String,default:"\u5F02\u5E38\u4FE1\u606F"}},setup(v,{expose:c}){const s=u(!1),l=u(""),p=n=>{l.value=n.exception+n.exception+n.exception,s.value=!0},m=n=>{n()};return c({show:p}),(n,b)=>{const g=i("yun-dialog");return w(),S(g,{modelValue:s.value,"onUpdate:modelValue":b[0]||(b[0]=f=>s.value=f),title:v.title,size:"large","confirm-button-handler":m,"confirm-button-text":"\u5173\u95ED","show-cancel-button":!1},{default:y(()=>[U("div",{class:"info",textContent:H(l.value)},null,8,Y)]),_:1},8,["modelValue","title"])}}};var j=N(A,[["__scopeId","data-v-ebad2332"]]);const G={__name:"retryDialog",emits:"done",setup(v,{expose:c,emit:s}){const l=u(!1),p=u({});function m(){l.value=!1}const n=u("SINGLE");async function b(f,r){r.value=!0;try{await P({retryNodeId:p.value.flowElementId,parentRequestId:p.value.requestId,retryType:n.value}),s("done"),f(),m()}finally{r.value=!1}}function g(f){l.value=!0,p.value=f}return c({show:g}),(f,r)=>{const D=i("el-option"),t=i("el-select"),e=i("yun-dialog");return w(),S(e,{modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=a=>l.value=a),size:"large",title:"\u91CD\u8BD5","confirm-button-text":"\u786E\u8BA4","cancel-button-text":"\u53D6\u6D88","confirm-button-handler":b,onClosed:m},{default:y(()=>[U("div",null,[h(" \u91CD\u8BD5\u65B9\u5F0F\uFF1A "),o(t,{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=a=>n.value=a)},{default:y(()=>[o(D,{label:"\u5355\u4E2A\u8282\u70B9",value:"SINGLE"}),o(D,{label:"\u6240\u6709\u8282\u70B9",value:"ALL"}),o(D,{label:"\u6B64\u8282\u70B9\u4EE5\u53CA\u4E4B\u540E",value:"AFTER"})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])}}};var J={__name:"detail",setup(v,{expose:c}){const s=u(!1),l=u(""),p=u(),m=u(),n=u(),b={page:1,size:10,total:0};async function g({pagination:e}){const{page:a,size:x}=e,_=await $({requestId:l.value,page:a,size:x});return{..._,records:_.elementExampleList.map(T=>{const{oilCard:d,...V}=T;return{...V,...d}})}}const f=async e=>{l.value=e.id,s.value=!0},r=M(()=>[{label:"\u529F\u80FD\u540D\u79F0",prop:"functionName"},{prop:"flowElementName",label:"\u8282\u70B9\u540D\u79F0"},{prop:"status",label:"\u6267\u884C\u72B6\u6001",render:({row:e})=>e.status==="SUSS"?"\u6210\u529F":"\u5931\u8D25"},{label:"\u5165\u53C2",prop:"requestParam",width:320,render:({row:e})=>o(i("json-viewer"),{value:e.requestParam,copyable:!0,sort:!0,"expand-depth":0},null)},{label:"\u51FA\u53C2",prop:"returnParam",width:320,render:({row:e})=>o(i("json-viewer"),{value:e.returnParam,copyable:!0,sort:!0,"expand-depth":0},null)},{label:"\u8017\u65F6",prop:"takeTime",render:({row:e})=>`${e.takeTime||"0"}ms`},{label:"\u5F02\u5E38\u4FE1\u606F",prop:"exception"},{label:"\u64CD\u4F5C",prop:"action"}]);function D(e){m.value.show(e)}async function t(e){n.value.show(e)}return c({show:f}),(e,a)=>{const x=i("el-button"),_=i("yun-pro-table"),T=i("yun-drawer");return w(),q(F,null,[o(T,{modelValue:s.value,"onUpdate:modelValue":a[1]||(a[1]=d=>s.value=d),title:"\u8BE6\u60C5",size:"X-large"},{default:y(()=>[s.value?(w(),S(_,{key:0,ref_key:"tableRef",ref:p,pagination:b,"onUpdate:pagination":a[0]||(a[0]=d=>b=d),"table-columns":k(r),"remote-method":g,"table-props":{stripe:!1}},{t_exception:y(({row:d})=>[d.status!=="SUSS"?(w(),S(x,{key:0,type:"action",onClick:V=>D(d)},{default:y(()=>[h(" \u67E5\u770B\u8BE6\u7EC6 ")]),_:2},1032,["onClick"])):C("v-if",!0)]),t_action:y(({row:d})=>[o(x,{type:"action",onClick:V=>t(d)},{default:y(()=>[h(" \u91CD\u8BD5 ")]),_:2},1032,["onClick"])]),_:1},8,["table-columns"])):C("v-if",!0)]),_:1},8,["modelValue"]),o(j,{ref_key:"exceptionDialogRef",ref:m},null,512),o(G,{ref_key:"retryDialogRef",ref:n,onDone:a[2]||(a[2]=d=>p.value.getData())},null,512)],64)}}},O={__name:"index",setup(v){const c=u(null),s=t=>{c.value.show(t)},l=[{label:"\u5E8F\u53F7",type:"index"},{label:"\u529F\u80FD\u540D\u79F0",prop:"functionName"},{label:"\u8BF7\u6C42\u7F16\u53F7",prop:"id"},{label:"\u6267\u884C\u72B6\u6001",prop:"status",render:({row:t})=>t.status==="SUSS"?"\u6210\u529F":"\u5931\u8D25"},{label:"\u6267\u884C\u5F00\u59CB\u65F6\u95F4",prop:"startTime",render:({row:t})=>I(t.startTime),width:180},{label:"\u6267\u884C\u7ED3\u675F\u65F6\u95F4",prop:"endTime",render:({row:t})=>I(t.endTime)},{label:"\u8017\u65F6",prop:"takeTime",render:({row:t})=>`${t.takeTime||"0"}ms`},{label:"\u64CD\u4F5C",prop:"action",render:({row:t})=>o(i("el-button"),{type:"action",onClick:()=>s(t)},{default:()=>[h("\u67E5\u770B\u8BE6\u60C5")]})}],p=[R("functionName","\u529F\u80FD\u540D\u79F0"),R("businessParam","\u4E1A\u52A1\u7F16\u53F7"),R("id","\u8BF7\u6C42\u7F16\u53F7")],m=u({}),{pagination:n,remoteMethod:b,tableProps:g,proTableRef:f,filterTableData:r}=z({apiFn:L,extParams:{},extQuerys:{sort:"createTime__DESC"},optimize:!0,async paramsHandler(t){return{...JSON.parse(JSON.stringify(t))}},responseHandler(t){const{flowExampleList:e,total:a}=t;return{records:e,total:a}},plugins:{config:{columns:l,searchFields:p},list:["SEARCH_PLUS"]}}),D=({searchData:t,filterData:e,pagination:a})=>{const x={...t,page:a.page,size:a.pageSize};return b({searchData:x,filterData:e,pagination:a})};return(t,e)=>{const a=i("yun-pro-table"),x=i("el-card");return w(),q(F,null,[o(x,{"body-style":{padding:"0 24px 24px 24px"},shadow:"never"},{default:y(()=>[o(a,{ref_key:"proTableRef",ref:f,pagination:k(n),"onUpdate:pagination":e[0]||(e[0]=_=>E(n)?n.value=_:null),"filter-data":k(r),"onUpdate:filter-data":e[1]||(e[1]=_=>E(r)?r.value=_:null),searchData:m.value,"onUpdate:searchData":e[2]||(e[2]=_=>m.value=_),"search-fields":p,"table-columns":l,"remote-method":D,"table-props":k(g)},null,8,["pagination","filter-data","searchData","table-props"])]),_:1}),o(J,{ref_key:"detailRef",ref:c},null,512)],64)}}};var Z=N(O,[["__scopeId","data-v-6edcf0eb"]]);export{Z as default};
