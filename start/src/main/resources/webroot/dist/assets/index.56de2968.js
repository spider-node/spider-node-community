import{u as P,a as R}from"./index.6a0f63a4.js";import{i as z}from"./types.22d094ed.js";import{h as x}from"./index.d9ff93cd.js";import{r as B,g as r,o as _,v as h,w as n,i as o,u as F,G as H,Y as V,b as O,s as D,t as M,U as J,c as L,y as Y,F as T,V as G,a as f,l as v,h as K,x as A,p as j,m as W}from"./index.f9827e98.js";function X(a,t){return x.request({url:"/select/bpmn",method:"post",data:a,params:t})}function Z(a,t){return x.request({url:"/deploy/bpmn",method:"post",data:a,params:t})}function $(a,t){return x.request({url:"/destroy/bpmn",method:"post",data:a,params:t})}function ee(a,t){return x.request({url:"/start/bpmn",method:"post",data:a,params:t})}const y={ENABLE:"ENABLE",DISABLE:"STOP"},te=[{label:"\u542F\u7528",value:y.ENABLE},{label:"\u7981\u7528",value:y.DISABLE}],ae={__name:"edit",emits:["success"],setup(a,{expose:t,emit:w}){const e=B(!1),u=B(),m={url:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"change"}],bpmnName:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"change"}],classPath:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"change"}],status:[{required:!0,message:"\u8BF7\u8F93\u5165",trigger:"change"}]},i=()=>({url:void 0,bpmnName:void 0,classPath:void 0,status:y.DISABLE}),l=B(i()),p=d=>{e.value=!0,e.value=!0,z(d)?l.value=i():l.value=JSON.parse(JSON.stringify(d))},b=()=>{l.value.status=l.value.status===y.DISABLE?y.ENABLE:y.DISABLE},g=async(d,c)=>{c.value=!0;try{await Z(l.value),d(),H({message:"\u606D\u559C\u4F60\uFF0C\u64CD\u4F5C\u6210\u529F",type:"success"}),w("success")}finally{c.value=!1}};return t({open:p}),(d,c)=>{const C=r("el-input"),E=r("el-form-item"),s=r("el-col"),N=r("el-switch"),k=r("el-row"),Q=r("el-form"),q=r("yun-drawer");return _(),h(q,{modelValue:e.value,"onUpdate:modelValue":c[2]||(c[2]=S=>e.value=S),size:"mediun",title:"\u7F16\u8F91","confirm-button-text":"\u786E\u5B9A","cancel-button-text":"\u53D6\u6D88",onConfirm:g},{default:n(()=>[o(Q,{ref_key:"formRef",ref:u,model:l.value,"label-width":"120px",rules:m},{default:n(()=>[o(k,null,{default:n(()=>[o(s,null,{default:n(()=>[o(E,{label:"url",prop:"url"},{default:n(()=>[o(C,{modelValue:l.value.url,"onUpdate:modelValue":c[0]||(c[0]=S=>l.value.url=S),style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),o(s,null,{default:n(()=>[o(E,{label:"bpmn\u5305\u540D\u79F0",prop:"bpmnName"},{default:n(()=>[o(C,{modelValue:l.value.bpmnName,"onUpdate:modelValue":c[1]||(c[1]=S=>l.value.bpmnName=S),style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),o(s,null,{default:n(()=>[o(E,{label:"\u529F\u80FD\u72B6\u6001",prop:"status"},{default:n(()=>[o(N,{"active-text":"\u542F\u7528","inactive-text":"\u7981\u7528","inline-prompt":"",value:l.value.status===F(y).ENABLE,onClick:b},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}};var I=({doQuery:a}={})=>({fetchData:async({searchData:u,pagination:m})=>await X({...u,...m}),handleToggleUninstall:async u=>{V.confirm("\u8BF7\u786E\u8BA4\u6B64\u64CD\u4F5C\u6267\u884C\u540E\u65E0\u4E0D\u826F\u540E\u679C\u3002","\u786E\u8BA4",{cancelButtonText:"\u53D6\u6D88",confirmButtonText:"\u786E\u5B9A",confirmButtonHandler:async(m,i)=>{i.value=!0;try{await $(u)}finally{i.value=!1}m(),await a()}})},handleInstall:async u=>{V.confirm("\u8BF7\u786E\u8BA4\u6B64\u64CD\u4F5C\u6267\u884C\u540E\u65E0\u4E0D\u826F\u540E\u679C\u3002","\u786E\u8BA4",{cancelButtonText:"\u53D6\u6D88",confirmButtonText:"\u786E\u5B9A",confirmButtonHandler:async(m,i)=>{i.value=!0;try{await ee({id:u.id})}finally{i.value=!1}m(),await a()}})}});const ne=[P("bpmnName","bpmn\u5305\u540D\u79F0"),R("status","\u72B6\u6001",{options:te})],le={name:"SDKCardList",components:{editDrawer:ae},setup(){const a=B([]),t=B(null),w=D({loading:{handleToggleUninstall:!1,doQuery:!1}}),{loading:e}=M(w),u=B({size:10,page:1,total:100,small:!0}),m=I(),{fetchData:i}=m;let l=D({});const p=async()=>{e.value.doQuery=!0;try{const d=await i({searchData:l,pagination:u.value});a.value=d.bpmns}finally{e.value.doQuery=!1}},b=d=>{t.value.open(d)},g=async()=>{l=D({}),p()};return J(()=>{p()}),{loading:e,...I({...w,doQuery:p}),editDrawerRef:t,pagination:u,cardlist:a,searchFields:ne,form:l,doQuery:p,handleReset:g,handleEdit:b,StatusType:y}}},U=a=>(j("data-v-cd402148"),a=a(),W(),a),oe={class:"cardlist"},se=U(()=>f("i",{class:"yun-iconfont icon-add cardlist-add-icon"},null,-1)),re={class:"cardlist-card-wrap"},ie={class:"cardlist-card-content"},ue=U(()=>f("div",{class:"cardlist-card-title"},A("BPMN"),-1)),de={class:"cardlist-card-info"},ce={class:"cardlist-card-opera"};function me(a,t,w,e,u,m){const i=r("yun-filter"),l=r("el-card"),p=r("el-col"),b=r("el-tag"),g=r("el-button"),d=r("el-row"),c=r("yun-pagination"),C=r("editDrawer"),E=G("loading");return _(),L(T,null,[Y((_(),h(l,{"body-style":{padding:"0 24px 24px 24px"},shadow:"never"},{default:n(()=>[o(i,{modelValue:e.form,"onUpdate:modelValue":t[0]||(t[0]=s=>e.form=s),mode:"search","form-props":{size:"small"},clearable:"",fields:e.searchFields,onSubmit:e.doQuery,onReset:e.handleReset},null,8,["modelValue","fields","onSubmit","onReset"]),f("div",oe,[o(d,{gutter:16},{default:n(()=>[o(p,{span:6},{default:n(()=>[o(l,{shadow:"never",class:"cardlist-add",onClick:t[1]||(t[1]=s=>e.handleEdit())},{default:n(()=>[se,v("\u6DFB\u52A0 ")]),_:1})]),_:1}),(_(!0),L(T,null,K(e.cardlist,(s,N)=>(_(),h(p,{key:N,span:6},{default:n(()=>[o(l,{shadow:"hover",class:"cardlist-card"},{default:n(()=>[f("div",re,[f("div",ie,[ue,f("div",de,[f("span",null,"bpmn\u540D\u79F0\uFF1A"+A(s.bpmnName),1),f("div",null,[v(" \u72B6\u6001\uFF1A "),s.status===e.StatusType.ENABLE?(_(),h(b,{key:0,type:"action"},{default:n(()=>[v(" \u542F\u7528 ")]),_:1})):(_(),h(b,{key:1,type:"danger"},{default:n(()=>[v(" \u7981\u7528 ")]),_:1}))])])])]),f("div",ce,[s.status===e.StatusType.ENABLE?(_(),h(g,{key:0,onClick:k=>a.handleToggleUninstall(s)},{default:n(()=>[v(" \u5378\u8F7D ")]),_:2},1032,["onClick"])):(_(),h(g,{key:1,onClick:k=>a.handleInstall(s)},{default:n(()=>[v(" \u542F\u7528 ")]),_:2},1032,["onClick"])),o(g,{type:"primary",onClick:k=>e.handleEdit(s)},{default:n(()=>[v(" \u7F16\u8F91 ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),o(c,{modelValue:e.pagination.size,"onUpdate:modelValue":t[2]||(t[2]=s=>e.pagination.size=s),currentPage:e.pagination.page,"onUpdate:currentPage":t[3]||(t[3]=s=>e.pagination.page=s),total:e.pagination.total,small:e.pagination.small,onSizeChange:e.doQuery,onCurrentChange:e.doQuery,onPrevClick:e.doQuery,onNextClick:e.doQuery},null,8,["modelValue","currentPage","total","small","onSizeChange","onCurrentChange","onPrevClick","onNextClick"])]),_:1})),[[E,e.loading.doQuery]]),o(C,{ref:"editDrawerRef",onSuccess:e.doQuery},null,8,["onSuccess"])],64)}var ge=O(le,[["render",me],["__scopeId","data-v-cd402148"]]);export{ge as default};
